sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[0:128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[128:256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[256:384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[384:512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[512:640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[640:768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[768:896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[896:1024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1024:1152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1152:1280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1280:1408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1408:1536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1536:1664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1664:1792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1792:1920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[1920:2048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2048:2176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2176:2304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2304:2432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2432:2560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2560:2688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2688:2816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2816:2944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[2944:3072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3072:3200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3200:3328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3328:3456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3456:3584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3584:3712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3712:3840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3840:3968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[3968:4096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4096:4224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4224:4352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4352:4480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4480:4608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4608:4736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4736:4864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4864:4992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[4992:5120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5120:5248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5248:5376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5376:5504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5504:5632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5632:5760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5760:5888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[5888:6016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6016:6144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6144:6272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6272:6400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6400:6528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6528:6656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6656:6784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6784:6912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[6912:7040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7040:7168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7168:7296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7296:7424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7424:7552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7552:7680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7680:7808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7808:7936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[7936:8064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8064:8192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8192:8320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8320:8448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8448:8576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8576:8704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8704:8832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8832:8960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[8960:9088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9088:9216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9216:9344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9344:9472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9472:9600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9600:9728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9728:9856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9856:9984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[9984:10112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10112:10240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10240:10368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10368:10496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10496:10624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10624:10752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10752:10880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[10880:11008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11008:11136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11136:11264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11264:11392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11392:11520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11520:11648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11648:11776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11776:11904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[11904:12032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12032:12160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12160:12288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12288:12416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12416:12544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12544:12672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12672:12800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12800:12928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[12928:13056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13056:13184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13184:13312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13312:13440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13440:13568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13568:13696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13696:13824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13824:13952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[13952:14080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14080:14208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14208:14336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14336:14464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14464:14592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14592:14720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14720:14848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14848:14976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[14976:15104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15104:15232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15232:15360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15360:15488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15488:15616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15616:15744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15744:15872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[15872:16000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16000:16128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16128:16256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16256:16384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16384:16512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16512:16640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16640:16768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16768:16896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[16896:17024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17024:17152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17152:17280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17280:17408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17408:17536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17536:17664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17664:17792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17792:17920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[17920:18048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18048:18176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18176:18304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18304:18432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18432:18560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18560:18688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18688:18816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18816:18944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[18944:19072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19072:19200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19200:19328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19328:19456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19456:19584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19584:19712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19712:19840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19840:19968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[19968:20096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20096:20224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20224:20352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20352:20480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20480:20608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20608:20736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20736:20864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20864:20992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[20992:21120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21120:21248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21248:21376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21376:21504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21504:21632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21632:21760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21760:21888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[21888:22016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22016:22144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22144:22272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22272:22400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22400:22528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22528:22656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22656:22784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22784:22912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[22912:23040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23040:23168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23168:23296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23296:23424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23424:23552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23552:23680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23680:23808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23808:23936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[23936:24064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24064:24192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24192:24320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24320:24448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24448:24576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24576:24704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24704:24832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24832:24960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[24960:25088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25088:25216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25216:25344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25344:25472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25472:25600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25600:25728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25728:25856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25856:25984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[25984:26112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26112:26240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26240:26368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26368:26496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26496:26624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26624:26752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26752:26880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[26880:27008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27008:27136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27136:27264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27264:27392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27392:27520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27520:27648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27648:27776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27776:27904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[27904:28032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28032:28160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28160:28288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28288:28416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28416:28544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28544:28672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28672:28800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28800:28928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[28928:29056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29056:29184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29184:29312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29312:29440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29440:29568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29568:29696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29696:29824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29824:29952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[29952:30080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30080:30208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30208:30336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30336:30464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30464:30592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30592:30720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30720:30848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30848:30976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[30976:31104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31104:31232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31232:31360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31360:31488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31488:31616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31616:31744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31744:31872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[31872:32000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32000:32128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32128:32256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32256:32384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32384:32512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32512:32640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32640:32768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32768:32896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[32896:33024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33024:33152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33152:33280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33280:33408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33408:33536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33536:33664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33664:33792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33792:33920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[33920:34048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34048:34176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34176:34304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34304:34432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34432:34560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34560:34688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34688:34816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34816:34944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[34944:35072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35072:35200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35200:35328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35328:35456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35456:35584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35584:35712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35712:35840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35840:35968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[35968:36096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36096:36224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36224:36352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36352:36480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36480:36608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36608:36736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36736:36864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36864:36992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[36992:37120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37120:37248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37248:37376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37376:37504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37504:37632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37632:37760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37760:37888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[37888:38016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38016:38144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38144:38272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38272:38400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38400:38528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38528:38656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38656:38784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38784:38912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[38912:39040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39040:39168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39168:39296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39296:39424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39424:39552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39552:39680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39680:39808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39808:39936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[39936:40064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40064:40192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40192:40320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40320:40448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40448:40576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40576:40704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40704:40832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40832:40960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[40960:41088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41088:41216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41216:41344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41344:41472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41472:41600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41600:41728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41728:41856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41856:41984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[41984:42112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42112:42240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42240:42368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42368:42496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42496:42624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42624:42752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42752:42880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[42880:43008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43008:43136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43136:43264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43264:43392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43392:43520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43520:43648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43648:43776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43776:43904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[43904:44032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44032:44160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44160:44288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44288:44416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44416:44544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44544:44672] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44672:44800] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44800:44928] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[44928:45056] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45056:45184] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45184:45312] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45312:45440] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45440:45568] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45568:45696] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45696:45824] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45824:45952] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[45952:46080] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46080:46208] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46208:46336] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46336:46464] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46464:46592] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46592:46720] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46720:46848] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46848:46976] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[46976:47104] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47104:47232] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47232:47360] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47360:47488] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47488:47616] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47616:47744] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47744:47872] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[47872:48000] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48000:48128] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48128:48256] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48256:48384] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48384:48512] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48512:48640] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48640:48768] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48768:48896] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[48896:49024] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49024:49152] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49152:49280] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49280:49408] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49408:49536] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49536:49664] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49664:49792] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49792:49920] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[49920:50048] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50048:50176] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50176:50304] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50304:50432] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50432:50560] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50560:50688] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50688:50816] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50816:50944] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[50944:51072] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51072:51200] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51200:51328] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51328:51456] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51456:51584] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51584:51712] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51712:51840] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51840:51968] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[51968:52096] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52096:52224] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52224:52352] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52352:52480] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52480:52608] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52608:52736] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52736:52864] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52864:52992] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[52992:53120] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53120:53248] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53248:53376] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53376:53504] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53504:53632] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53632:53760] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53760:53888] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[53888:54016] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54016:54144] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54144:54272] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54272:54400] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54400:54528] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54528:54656] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54656:54784] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60416:60544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54784:54912] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60416:60544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[54912:55040] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60416:60544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55040:55168] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55168:55296] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55296:55424] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55424:55552] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55552:55680] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55680:55808] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55808:55936] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[55936:56064] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56064:56192] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56192:56320] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56320:56448] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56448:56576] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56576:56704] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56704:56832] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56832:56960] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[56960:57088] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57088:57216] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57216:57344] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57344:57472] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57472:57600] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57600:57728] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57728:57856] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57856:57984] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:0 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[57984:58112] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58112:58240] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58240:58368] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58368:58496] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58496:58624] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58624:58752] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58752:58880] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[58880:59008] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59008:59136] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59136:59264] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59264:59392] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60416:60544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59392:59520] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59520:59648] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:1 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59648:59776] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59776:59904] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[59904:60032] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60032:60160] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60416:60544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60160:60288] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:3 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60288:60416] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
DEBUG chunk[60416:60544] sel_scores.shape=(2, 128, 1536) topk_idx.shape=(2, 128, 512) device=cuda:2 L=1536 topk_min_max=(0,1535)
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
sel_scores.shape: torch.Size([2, 128, 1536])
